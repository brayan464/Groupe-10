<Window x:Class="EditeurWpf.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Word Pro avec IA" Height="750" Width="1400"
        Background="#1E1E1E">

    <Window.Resources>
        <SolidColorBrush x:Key="BgDark" Color="#1E1E1E"/>
        <SolidColorBrush x:Key="BgLightDark" Color="#2D2D30"/>
        <SolidColorBrush x:Key="FgWhite" Color="White"/>
        <SolidColorBrush x:Key="BorderColor" Color="#555555"/>

        <Style TargetType="Button" x:Key="ToolButton">
            <Setter Property="Background" Value="{StaticResource BgLightDark}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="BorderBrush" Value="#555555"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Height" Value="28"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#3E3E42"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="MenuItem">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="#2D2D30"/>
        </Style>

        <Style TargetType="Separator">
            <Setter Property="Background" Value="#555555"/>
            <Setter Property="Margin" Value="5,0"/>
        </Style>

        <Style TargetType="Label">
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="Background" Value="#3A3A3A"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#666666"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="CaretBrush" Value="White"/>
        </Style>

        <Style TargetType="ComboBox">
            <Setter Property="Background" Value="#3A3A3A"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#666666"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <Style TargetType="ComboBoxItem">
            <Setter Property="Background" Value="#3A3A3A"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="350"/>
        </Grid.ColumnDefinitions>

        <!-- Zone Éditeur -->
        <DockPanel Grid.Column="0">

            <!-- MENU PRINCIPAL -->
            <Menu DockPanel.Dock="Top" Background="#2D2D30" Foreground="White">
                <MenuItem Header="📁 Fichier" Foreground="White">
                    <MenuItem Header="Nouveau" Click="NewFile_Click" InputGestureText="Ctrl+N"/>
                    <MenuItem Header="Ouvrir..." Click="OpenFile_Click" InputGestureText="Ctrl+O"/>
                    <MenuItem Header="Enregistrer" Click="SaveFile_Click" InputGestureText="Ctrl+S"/>
                    <MenuItem Header="Enregistrer sous..." Click="SaveAsFile_Click"/>
                    <Separator Background="#555555"/>
                    <MenuItem Header="Exporter en PDF" Click="ExportPDF_Click"/>
                    <MenuItem Header="Imprimer..." Click="Print_Click" InputGestureText="Ctrl+P"/>
                    <Separator Background="#555555"/>
                    <MenuItem Header="Quitter" Click="Exit_Click"/>
                </MenuItem>

                <MenuItem Header="✏️ Édition" Foreground="White">
                    <MenuItem Header="Annuler" Click="Undo_Click" InputGestureText="Ctrl+Z"/>
                    <MenuItem Header="Rétablir" Click="Redo_Click" InputGestureText="Ctrl+Y"/>
                    <Separator Background="#555555"/>
                    <MenuItem Header="Couper" Click="Cut_Click" InputGestureText="Ctrl+X"/>
                    <MenuItem Header="Copier" Click="Copy_Click" InputGestureText="Ctrl+C"/>
                    <MenuItem Header="Coller" Click="Paste_Click" InputGestureText="Ctrl+V"/>
                    <Separator Background="#555555"/>
                    <MenuItem Header="Tout sélectionner" Click="SelectAll_Click" InputGestureText="Ctrl+A"/>
                </MenuItem>

                <MenuItem Header="➕ Insertion" Foreground="White">
                    <MenuItem Header="Image..." Click="InsertImage_Click"/>
                    <MenuItem Header="Tableau..." Click="InsertTable_Click"/>
                    <MenuItem Header="Saut de page" Click="InsertPageBreak_Click"/>
                    <MenuItem Header="Date et heure" Click="InsertDate_Click"/>
                    <Separator Background="#555555"/>
                    <MenuItem Header="💧 Filigrane" Click="InsertWatermark_Click"/>
                </MenuItem>

                <MenuItem Header="📐 Mise en page" Foreground="White">
                    <MenuItem Header="Marges..." Click="PageMargins_Click"/>
                    <MenuItem Header="Orientation" Click="PageOrientation_Click"/>
                    <MenuItem Header="Taille..." Click="PageSize_Click"/>
                    <MenuItem Header="Bordures..." Click="PageBorders_Click"/>
                    <Separator Background="#555555"/>
                    <MenuItem Header="📝 En-tête et pied de page..." Click="HeaderFooter_Click"/>
                </MenuItem>

                <MenuItem Header="🎨 Format" Foreground="White">
                    <MenuItem Header="Police..." Click="Font_Click"/>
                    <MenuItem Header="Couleur du texte..." Click="Color_Click"/>
                    <MenuItem Header="Surlignage..." Click="Highlight_Click"/>
                </MenuItem>
            </Menu>

            <!-- BARRE D'OUTILS PRINCIPALE -->
            <ToolBar DockPanel.Dock="Top" Background="#2D2D30" Height="40" BorderBrush="#555555" BorderThickness="0,1">
                <Button Style="{StaticResource ToolButton}" Click="NewFile_Click" ToolTip="Nouveau">📄</Button>
                <Button Style="{StaticResource ToolButton}" Click="OpenFile_Click" ToolTip="Ouvrir">📂</Button>
                <Button Style="{StaticResource ToolButton}" Click="SaveFile_Click" ToolTip="Enregistrer">💾</Button>
                <Button Style="{StaticResource ToolButton}" Click="Print_Click" ToolTip="Imprimer">🖨️</Button>

                <Separator Background="#555555"/>

                <Button Style="{StaticResource ToolButton}" Click="Undo_Click" ToolTip="Annuler">↶</Button>
                <Button Style="{StaticResource ToolButton}" Click="Redo_Click" ToolTip="Rétablir">↷</Button>

                <Separator Background="#555555"/>

                <Button Style="{StaticResource ToolButton}" Click="Bold_Click" FontWeight="Bold" ToolTip="Gras">B</Button>
                <Button Style="{StaticResource ToolButton}" Click="Italic_Click" ToolTip="Italique">
                    <Italic>I</Italic>
                </Button>
                <Button Style="{StaticResource ToolButton}" Click="Underline_Click" ToolTip="Souligné">
                    <Underline>U</Underline>
                </Button>

                <Separator Background="#555555"/>

                <Button Style="{StaticResource ToolButton}" Click="Color_Click" ToolTip="Couleur texte">🎨</Button>
                <Button Style="{StaticResource ToolButton}" Click="Highlight_Click" ToolTip="Surlignage">🖍️</Button>

                <Separator Background="#555555"/>

                <Button Style="{StaticResource ToolButton}" Click="AlignLeft_Click" ToolTip="Aligner à gauche">◀</Button>
                <Button Style="{StaticResource ToolButton}" Click="AlignCenter_Click" ToolTip="Centrer">▣</Button>
                <Button Style="{StaticResource ToolButton}" Click="AlignRight_Click" ToolTip="Aligner à droite">▶</Button>
                <Button Style="{StaticResource ToolButton}" Click="AlignJustify_Click" ToolTip="Justifier">▦</Button>

                <Separator Background="#555555"/>

                <Button Style="{StaticResource ToolButton}" Click="BulletList_Click" ToolTip="Liste à puces">•</Button>
                <Button Style="{StaticResource ToolButton}" Click="NumberedList_Click" ToolTip="Liste numérotée">1.</Button>
            </ToolBar>

            <!-- BARRE DE FORMATAGE -->
            <ToolBar DockPanel.Dock="Top" Background="#252526" Height="35" BorderBrush="#555555" BorderThickness="0,1">
                <Label Content="Style:" Foreground="White" VerticalAlignment="Center"/>
                <ComboBox x:Name="StyleCombo" Width="140" SelectionChanged="Style_Changed" 
                          Background="#3A3A3A" Foreground="White" BorderBrush="#666666" BorderThickness="1">
                    <ComboBoxItem Content="Normal" Tag="Normal" IsSelected="True" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="Titre" Tag="Title" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="Titre 1" Tag="Heading1" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="Titre 2" Tag="Heading2" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="Titre 3" Tag="Heading3" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="Sous-titre" Tag="Subtitle" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="Citation" Tag="Quote" Background="#3A3A3A" Foreground="White"/>
                </ComboBox>

                <Separator Background="#555555"/>

                <Label Content="Taille:" Foreground="White" VerticalAlignment="Center"/>
                <ComboBox x:Name="FontSizeCombo" Width="60" SelectionChanged="FontSize_Changed" 
                          Background="#3A3A3A" Foreground="White" BorderBrush="#666666" BorderThickness="1">
                    <ComboBoxItem Content="8" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="9" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="10" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="11" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="12" IsSelected="True" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="14" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="16" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="18" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="20" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="22" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="24" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="28" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="36" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="48" Background="#3A3A3A" Foreground="White"/>
                    <ComboBoxItem Content="72" Background="#3A3A3A" Foreground="White"/>
                </ComboBox>

                <Separator Background="#555555"/>

                <Label Content="🔍" Foreground="White" VerticalAlignment="Center"/>
                <TextBox x:Name="SearchBox" Width="120" Background="#3A3A3A" Foreground="White" 
                         BorderBrush="#666666" BorderThickness="1" Padding="3" VerticalAlignment="Center" 
                         CaretBrush="White"/>
                <Button Style="{StaticResource ToolButton}" Click="Search_Click">Rechercher</Button>

                <Separator Background="#555555"/>

                <Label Content="♻" Foreground="White" VerticalAlignment="Center"/>
                <TextBox x:Name="ReplaceBox" Width="100" Background="#3A3A3A" Foreground="White" 
                         BorderBrush="#666666" BorderThickness="1" Padding="3" VerticalAlignment="Center" 
                         CaretBrush="White"/>
                <Button Style="{StaticResource ToolButton}" Click="Replace_Click">Remplacer</Button>
            </ToolBar>

            <!-- BARRE D'ÉTAT EN BAS -->
            <StatusBar DockPanel.Dock="Bottom" Background="#2D2D30" Height="25" BorderBrush="#555555" BorderThickness="0,1,0,0">
                <StatusBarItem>
                    <Label x:Name="PageCountLabel" Content="📄 Page 1" Foreground="White" FontSize="11"/>
                </StatusBarItem>
                <Separator Background="#555555"/>
                <StatusBarItem>
                    <Label x:Name="WordCountLabel" Content="📝 0 mots" Foreground="White" FontSize="11"/>
                </StatusBarItem>
                <Separator Background="#555555"/>
                <StatusBarItem>
                    <Label x:Name="CharCountLabel" Content="🔤 0 caractères" Foreground="White" FontSize="11"/>
                </StatusBarItem>
            </StatusBar>

            <!-- ÉDITEUR RICHTEXT avec Grid parent pour le filigrane -->
            <Grid>
                <Border BorderBrush="#666666" BorderThickness="2" Margin="5">
                    <RichTextBox x:Name="Editor"
                                 AcceptsTab="True"
                                 VerticalScrollBarVisibility="Auto"
                                 Background="#FFFFFF"
                                 Foreground="#000000"
                                 FontSize="12"
                                 FontFamily="Calibri"
                                 Padding="40,20,40,20"
                                 BorderThickness="0">
                    </RichTextBox>
                </Border>
            </Grid>
        </DockPanel>

        <!-- PANNEAU IA -->
        <Border Grid.Column="1" Background="#252526" BorderBrush="#555555" BorderThickness="2,0,0,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header -->
                <StackPanel Grid.Row="0" Background="#2D2D30" Height="40">
                    <Label Content="🤖 Assistant IA" Foreground="White" VerticalAlignment="Center" 
                           FontWeight="Bold" Margin="10,0" FontSize="14"/>
                </StackPanel>

                <!-- Config API -->
                <Expander Grid.Row="1" Header="⚙️ Configuration API" Foreground="White" 
                          Background="#2D2D30" IsExpanded="False" Margin="5" 
                          BorderBrush="#555555" BorderThickness="1">
                    <Border Margin="5" Background="#2D2D30">
                        <StackPanel>
                            <Border Background="#1E1E1E" Margin="0,0,0,10" CornerRadius="5" 
                                    BorderBrush="#555555" BorderThickness="1">
                                <StackPanel Margin="10">
                                    <TextBlock Text="💬 Chat (OpenRouter)" Foreground="#4CAF50" 
                                               FontWeight="Bold" Margin="0,0,0,5"/>
                                    <Label Content="Clé API:" Foreground="White" Padding="0,5,0,2"/>
                                    <PasswordBox x:Name="ApiKeyOpenRouter" Background="#3A3A3A" 
                                                 Foreground="White" Margin="0,0,0,5" 
                                                 BorderBrush="#666666" BorderThickness="1" Padding="5"/>
                                </StackPanel>
                            </Border>

                            <Border Background="#1E1E1E" Margin="0,0,0,10" CornerRadius="5" 
                                    BorderBrush="#555555" BorderThickness="1">
                                <StackPanel Margin="10">
                                    <TextBlock Text="🎤 Audio (Groq)" Foreground="#2196F3" 
                                               FontWeight="Bold" Margin="0,0,0,5"/>
                                    <Label Content="Clé API:" Foreground="White" Padding="0,5,0,2"/>
                                    <PasswordBox x:Name="ApiKeyOpenAI" Background="#3A3A3A" 
                                                 Foreground="White" Margin="0,0,0,5" 
                                                 BorderBrush="#666666" BorderThickness="1" Padding="5"/>
                                </StackPanel>
                            </Border>

                            <Button Content="💾 Sauvegarder" Click="SaveApiKeys_Click" 
                                    Style="{StaticResource ToolButton}" Height="30"/>
                        </StackPanel>
                    </Border>
                </Expander>

                <!-- Actions rapides -->
                <Expander Grid.Row="2" Header="⚡ Actions rapides" Foreground="White" 
                          Background="#2D2D30" IsExpanded="True" Margin="5" 
                          BorderBrush="#555555" BorderThickness="1">
                    <Border Margin="5" Background="#2D2D30">
                        <StackPanel>
                            <Button Content="✅ Corriger" Click="QuickCorrect_Click" 
                                    Style="{StaticResource ToolButton}" Height="32" Margin="0,2"/>
                            <Button Content="📊 Résumer" Click="QuickSummarize_Click" 
                                    Style="{StaticResource ToolButton}" Height="32" Margin="0,2"/>
                            <Button Content="✨ Améliorer" Click="QuickImprove_Click" 
                                    Style="{StaticResource ToolButton}" Height="32" Margin="0,2"/>
                            <Button Content="🌍 Traduire" Click="QuickTranslate_Click" 
                                    Style="{StaticResource ToolButton}" Height="32" Margin="0,2"/>
                        </StackPanel>
                    </Border>
                </Expander>

                <!-- Chat -->
                <ScrollViewer Grid.Row="3" VerticalScrollBarVisibility="Auto" Background="#1E1E1E" 
                              Margin="5" x:Name="ChatScrollViewer" BorderBrush="#555555" BorderThickness="1">
                    <StackPanel x:Name="ChatPanel" Margin="5"/>
                </ScrollViewer>

                <!-- Zone de saisie -->
                <Border Grid.Row="4" Background="#2D2D30" Margin="5" 
                        BorderBrush="#666666" BorderThickness="1" CornerRadius="3">
                    <Grid Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBox Grid.Row="0" x:Name="PromptBox" 
                                 Background="#3A3A3A" 
                                 Foreground="White" 
                                 TextWrapping="Wrap" 
                                 AcceptsReturn="True"
                                 Height="80"
                                 VerticalScrollBarVisibility="Auto"
                                 BorderBrush="#666666"
                                 BorderThickness="1"
                                 Padding="5"
                                 FontSize="12"
                                 CaretBrush="White"/>

                        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,5,0,0">
                            <Button x:Name="RecordButton" Content="🎤" Click="Record_Click" 
                                    Style="{StaticResource ToolButton}" Width="80" Height="30"/>
                            <Button Content="📤 Envoyer" Click="SendMessage_Click" 
                                    Style="{StaticResource ToolButton}" Width="90" Height="30" 
                                    Margin="5,0,0,0" FontWeight="Bold"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Border>
    </Grid>
</Window>